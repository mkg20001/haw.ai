<!DOCTYPE html>
<html data-lt-installed="true">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

  <title>Die MASCHINE</title>
  <link rel="stylesheet" type="text/css" href="./assets/style2.css">
  <link rel="stylesheet" type="text/css" href="./assets/cube.css">
  <script src="./assets/jquery-2.1.1.min.js"></script>
  <script type="text/javascript">
    // INPUT/OUTPUT
    $(document).ready(function() {
      // Fokus Input-Feld
      $('input#userInput').focus();
      // Bei Klick in Coinainter - Fokus auf Input-Feld
      $('body').keydown(function() {
        $('input#userInput').focus();
      });
      // Enter (Key 13)
      $('input#userInput').keyup(function(event) {
        if (event.keyCode == 13 && $('p.MASCHINE').is(':empty') == false) {
          // Absätze erzeugen, nach letzten <p>
          $('p.MASCHINE').last().after('<p class="user" id="inputOutput"></p><p class="MASCHINE" id="output"></p>');
          // User Input $user: Output
          $('p.user#inputOutput').text($(this).val());
          // Variable für Input
          var input = $('p.user#inputOutput').text();
          var input = input.replace(/\+/, "[plus]");
          // user input Id entfernen
          $('p.user#inputOutput').removeAttr('id');
          // Input-Feld zurücksetzen
          $('input#userInput').val('');

          window.fetch('/io', { method: 'POST', body: JSON.stringify({ input }) }).then(res => res.json()).then(res => {
            document.getElementById('output').innerHTML = '<p>' + res.text + '</p>'
          })

          // Scroll to Bottom
          $('p.MASCHINE').on("DOMSubtreeModified", function() {
            $("html, body").animate({
              scrollTop: $(document).height()
            }, "slow");
          });
          $("html, body").animate({
            scrollTop: $(document).height()
          }, "slow");
        }

      });
    });
  </script>
</head>

<body>
  <div id="container">

    <!-- Chat -->
    <p class="invisible user"></p>
    <p class="invisible MASCHINE">$nbsp;</p>
    <!-- User-Input -->
    <label for="userInput">$user: </label>
    <input type="text" id="userInput" name="userInput" spellcheck="false">
  </div>

  <div class="mainframe">
    <!-- Hire Hugo Darby-Brown, the publisher of the cube, at http://codepen.io/hugo/ -->
    <cube>
      <back></back>
      <bottom></bottom>
      <front></front>
      <left></left>
      <right></right>
      <top></top>
    </cube>
  </div>



  <!--
playback timings (ms):
  PetaboxLoader3.datanode: 167.701 (4)
  PetaboxLoader3.resolve: 240.587 (2)
  esindex: 0.016
  captures_list: 1127.548
  exclusion.robots.policy: 0.369
  CDXLines.iter: 11.187 (3)
  RedisCDXSource: 96.151
  load_resource: 65.398
  LoadShardBlock: 1015.812 (3)
  exclusion.robots: 1.227
-->
</body>

</html>
